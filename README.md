# Introduction 
The goal of this project is to build a MC68000 emulator in modern C++ working both in Windows and Linux.

# Getting Started
If you are running on Windows, make sure that the boost library is installed in \code\lib\boost. You can download the boost library from https://www.boost.org/users/download/. The recommendation is to use the .7z archive and to use https://www.7-zip.org/ to decompress it. If a specific version is in place like \code\lib\boost_1_82_0 you can do
```
push-location C:\code\lib
New-Item -Name boost -ItemType SymbolicLink -Value .\boost_1_82_0\
```
If you are running on Linux the boost library should be present in /usr/include/boost. If you have a specific version insatlled you can create a link by doing:
```
cd /usr/include
sudo ln -s boost_1_84_0/ boost
```


# Building and Testing
To create the makefile just run the following command:
```
cmake .
```
To build the code just do
```
cmake --build .
```
To run the tests
```
bin/coretest -p          (on linux)
bin/cputest -p
bin/dasmtest -p

bin\coretest.exe -p      (on windows)
bin\cputest.exe -p
bin\dasmtest.exe -p
```

# Building the assembler
The assembler and the corresponding test are in the asm folder and aren't yet integrated with the main makefile. To build this project, you will need Java to be installed.
Java can be installed from https://www.oracle.com/java/technologies/javase/jdk17-archive-downloads.html . 
To build this project, you have to move to the asm folder and do
```
cmake .
cmake --build .
```

To run the assembler unit tests
```
bin/asm68000test -p         (on linux)
bin\asm68000test.exe -p     (on windows)
```

# Validating the overall solution
To validate that assembler and interpreter are working correctly together you can assemble, run and then debug a small game of number guessing. The source is in asm/example/game.68k.
The whole approach will be:

1. Compile the game
```
cd asm/examples
../../asm68000 -o -s game.68k        (on linux)
..\..\asm68000.exe -o -s game.68k    (on windows)
```
- The -o or --output argument is used to generate the binary.
- The -s or --symbols argument is used to generate the symbol table to be used while debugging.

2. Run the game

You can now run the game passing the name of the binary file that was generated by the assembler.
```
../../bin/run68000 game.bin           (on linux)
..\..\bin\run68000.exe game.bin       (on windows)
```

3. Debugging the code

You can also debug the code by using the -d or --debug option and optionally specifying the location of the symbols file with the -s or --symbols option.
```
../../bin/run68000 -d game.bin        (on linux)
..\..\bin/run68000.exe -d game.bin    (on windows)
```


# A basic interpreter
The asm/examples folder contains an adaptation of the **Tiny BASIC for the Motorola MC6000** as it was introduced in the *Dr Dobb's Toolbook of 68000 Programming*. 
The codehas been slightly adjusted to account for the difference in the environment in particular the basic IO routines. 
You can run it from the asm/examples folder by doing
```
../../bin/run68000 tiny.bin           (on linux)
..\..\bin\run68000.exe tiny.bin       (on windows)
```


